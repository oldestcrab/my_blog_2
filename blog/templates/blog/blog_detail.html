<!--
 * @Description: 博客详细展示页面
 * @Author: oldestcrab
 * @Github:
 * @Date: 2019-09-24 08:50:36
 * @LastEditors: oldestcrab
 * @LastEditTime: 2019-09-26 14:07:13
 -->
{% extends "base.html" %}
{% block title %}
{{ blog.title }}
{% endblock title %}
{% load staticfiles %}
{% block header_extends %}
<link rel="stylesheet" href="{% static 'blog.css' %}">
{% endblock header_extends %}
{% block nav_blog_active %}
active
{% endblock nav_blog_active %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-xs-10 col-xd-offset-1">
            <h3>{{ blog.title }}</h3>
            <ul class="blog-info-description">
                <li>作者：{{ blog.author}}</li>
                <li>分类：<a href="{% url 'blog:blogs_with_type' blog.blog_type.id %}">{{ blog.blog_type }}</a></li>
                <li>发表日期：{{ blog.created_time|date:'Y-m-d H:n:s'}}</li>
                <li>阅读量：{{ blog.get_read_num}}</li>
            </ul>
            <div class="blog-content">{{ blog.content|safe }}</div>
            <div class="blog-more">
                <P>上一篇：
                    {# 上一篇 #}
                    {% if previous_blog  %}
                    <a href="{% url 'blog:blog_detail' previous_blog.id %}">{{ previous_blog.title }}</a>
                    {% else %}
                    这是最早的一篇文章哦
                    {% endif %}
                </p>
                <P>下一篇：
                    {# 下一篇 #}
                    {% if next_blog  %}
                    <a href="{% url 'blog:blog_detail' next_blog.id %}">{{ next_blog.title }}</a>
                    {% else %}
                    已经是最新一篇了哦
                    {% endif %}
                </p>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-10 col-xd-offset-1">
            <div class="comment-area">
                <h3 class="comment-area-title">提交评论</h3>
                {% if user.is_authenticated %}
                <form action="" method="POST" style="overflow: hidden">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="comment_text">{{ user.username }},欢迎评论</label>
                        <textarea id="comment_text" class="form-control" name="text" rows="4"></textarea>
                    </div>

                    <input type="hidden" name="object_id" value="{{ blog.pk }}">
                    <input type="hidden" name="content_type" value="blog">
                    <input type="submit" value="评论" class="btn btn-primary" style="float:right">
                </form>
                {% else %}
                未登录，登录之后方可评论
                <a href="{% url 'register' %}?from={{ request.get_full_path }}" class="btn btn-danger">注册</a>or
                <a href="{% url 'login' %}?from={{ request.get_full_path }}" class="btn btn-primary">登录</a>
                {% endif %}
            </div>
            <div class="comment-area">
                <h3 class="comment-area-title">评论列表</h3>
                {% for comment in comments %}
                <div>
                    {{ comment.user.username }}
                    {{ comment.comment_time|date:'Y-m-d H:n:s' }}
                    {{ comment.text }}
                </div>


                {% empty %}
                暂无评论
                <a href=""></a>
                {% endfor %}
            </div>
        </div>

    </div>

</div>
{% endblock content %}